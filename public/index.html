<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>NAFIJ. — OTP Automation</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg1:#0f172a;
      --bg2:#1e293b;
      --acc:#22c55e;
      --acc-2:#84cc16;
      --card:#111827aa;
      --text:#e5e7eb;
      --muted:#94a3b8;
      --ring:#ffffff33;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; color:var(--text); font-family: ui-sans-serif, system-ui, -apple-system,
      Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background:
        radial-gradient(1200px 600px at 20% -10%, #334155 0%, transparent 60%),
        radial-gradient(900px 500px at 120% 10%, #14532d 0%, transparent 55%),
        linear-gradient(135deg, var(--bg1), var(--bg2));
      overflow-x:hidden;
    }
    .nav{
      position:fixed; inset:0 auto auto 0; width:100%; height:64px;
      display:flex; align-items:center; justify-content:center;
      backdrop-filter: blur(10px);
      background: linear-gradient(to bottom, #0b1222aa, #0b122200);
      z-index:50; border-bottom:1px solid #ffffff10;
    }
    .nav-inner{ width:min(1100px, 92%); display:flex; align-items:center; justify-content:space-between; }
    .brand{ font-weight:800; font-size: clamp(20px, 2.6vw, 28px); display:flex; align-items:center; gap:.5rem; }
    .brand .dot{ color:var(--acc); }
    .hero{ padding-top:100px; text-align:center; animation: fadeInUp .8s ease both; }
    .headline{ font-size: clamp(28px, 4.4vw, 46px); font-weight:900; margin:12px 0 6px; }
    .sub{ color:var(--muted); max-width:680px; margin:auto; }
    .spark-loader{ font-size:34px; color:var(--acc); font-weight:900; animation: blink 1s infinite alternate; display:inline-block; margin-left:8px; }
    .wrap{ display:grid; place-items:center; padding: 12px 0 80px }
    .card{
      width:min(860px, 92%); margin-top:18px;
      background: linear-gradient(180deg, #0b1222cc, #0b122280);
      border:1px solid #ffffff1a;
      border-radius:24px; padding: clamp(18px, 3vw, 26px);
      box-shadow: 0 10px 40px #00000066, inset 0 1px 0 #ffffff14;
    }
    .card-head{ display:flex; align-items:center; justify-content:space-between; flex-wrap:wrap; margin-bottom:14px; }
    .badge{ padding:.35rem .6rem; border-radius:999px; font-size:12px; background:#16a34a22; color:#86efac; border:1px solid #16a34a55; }
    .form{ display:grid; grid-template-columns: 1fr auto; gap:12px; }
    textarea.input{
      width:100%; min-height:80px; resize:vertical;
      padding:14px; font-size:16px; color:var(--text);
      background:#0b1222; border:1px solid var(--ring);
      border-radius:14px;
    }
    .btn{ padding:14px 18px; font-weight:800; font-size:16px; border-radius:14px;
      background:linear-gradient(135deg, #22c55e, #84cc16); color:#052e16; border:none; cursor:pointer; }
    .loader{ width:26px; height:26px; border-radius:50%; border: 3px solid #ffffff2e; border-top-color:#fff; animation: spin 1s linear infinite; display:inline-block; }
    footer{ text-align:center; color:var(--muted); padding:26px 0 46px; font-size:13px; }
    .heart{ display:inline-block; color:var(--acc-2); animation: heartbeat 1.2s infinite; margin-left:4px; }
    @keyframes fadeInUp{from{opacity:0; transform:translateY(10px)} to{opacity:1; transform:translateY(0)}}
    @keyframes blink{from{opacity:.4} to{opacity:1}}
    @keyframes spin{to{transform:rotate(360deg)}}
    @keyframes heartbeat{ 0%,100%{transform:scale(1)} 50%{transform:scale(1.3)} }
  </style>
</head>
<body>
  <div class="nav">
    <div class="nav-inner">
      <div class="brand">NAFIJ<span class="dot">.</span></div>
    </div>
  </div>

  <section class="hero">
    <p class="badge">OTP Automation • Multi Session</p>
    <h1 class="headline">Automate OTP flows <span class="spark-loader">✦</span></h1>
    <p class="sub">Enter up to <strong>3 numbers/emails</strong> (comma or new line). Each can run multiple sessions.</p>
  </section>

  <main class="wrap">
    <div class="card">
      <div class="card-head">
        <div class="card-title">Run Sessions</div>
        <div class="badge" id="statusBadge">Idle</div>
      </div>

      <form id="otpForm" class="form" autocomplete="off">
        <textarea class="input" id="phones" placeholder="019XXXXXXX, 017XXXXXXX, email@example.com" required></textarea>
        <input type="number" id="count" min="1" max="5" value="1" style="width:80px; border-radius:14px; padding:10px;" title="Number of sessions">
        <button class="btn" id="startBtn" type="submit">Start</button>
      </form>

      <div class="status" id="result">Ready.</div>
      <div id="shots"></div>
    </div>
  </main>

  <footer>
    © <span id="yy"></span> NAFIJ<span style="color:#22c55e">.</span> Created for Future<span class="heart">❤</span>
  </footer>

  <script>
    document.getElementById('yy').textContent = new Date().getFullYear();

    const form = document.getElementById('otpForm');
    const result = document.getElementById('result');
    const shots = document.getElementById('shots');
    const badge = document.getElementById('statusBadge');
    const startBtn = document.getElementById('startBtn');
    const countInput = document.getElementById('count');

    function setBusy(b){
      if(b){
        startBtn.disabled = true;
        startBtn.innerHTML = '<span class="loader"></span> Running';
        badge.textContent = 'Working…';
      }else{
        startBtn.disabled = false;
        startBtn.textContent = 'Start';
        badge.textContent = 'Idle';
      }
    }

    function renderImages(phone, sessionIndex, urls){
      const container = document.createElement('div');
      container.style.marginTop = "20px";
      container.innerHTML = `<h3>${phone} • Session ${sessionIndex}</h3>`;
      urls.forEach((u,i)=>{
        const img = document.createElement('img');
        img.src = u;
        img.alt = "Screenshot "+(i+1);
        img.style.width = "30%";
        img.style.margin="6px";
        container.appendChild(img);
      });
      shots.appendChild(container);
    }

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const inputVal = document.getElementById('phones').value.trim();
      if (!inputVal) return;

      const numbers = inputVal.split(/[\n,]+/).map(s=>s.trim()).filter(Boolean).slice(0,3);
      const count = parseInt(countInput.value) || 1;
      shots.innerHTML = '';
      setBusy(true);
      result.textContent = 'Launching automation...';

      for(const phone of numbers){
        try {
          const res = await fetch('/start', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ value: phone, count })
          });
          const data = await res.json();
          if(res.ok && data.results){
            data.results.forEach((r,i)=>{
              const urls = r.screenshot ? [r.screenshot] : [];
              renderImages(phone, i+1, urls);
            });
          } else {
            renderImages(phone, 1, [data.errorScreenshot || '']);
          }
        } catch(err){
          renderImages(phone, 1, []);
        }
      }

      result.textContent = 'Done.';
      setBusy(false);
    });
  </script>
</body>
</html>

